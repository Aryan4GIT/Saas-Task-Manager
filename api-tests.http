### API Testing with curl
### Save this file as api-tests.http or use with REST Client extension in VS Code

### Variables
@baseUrl = http://localhost:8080/api/v1
@accessToken = your-access-token-here
@refreshToken = your-refresh-token-here

### Health Check
GET http://localhost:8080/health

### ============================================
### Authentication
### ============================================

### Register new organization and admin user
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "org_name": "Test Company",
  "email": "admin@test.com",
  "password": "password123",
  "first_name": "Admin",
  "last_name": "User"
}

### Login (use seeded data)
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "admin@acme.com",
  "password": "password123"
}

### Refresh Access Token
POST {{baseUrl}}/auth/refresh
Content-Type: application/json

{
  "refresh_token": "{{refreshToken}}"
}

### Get Current User Info
GET {{baseUrl}}/auth/me
Authorization: Bearer {{accessToken}}

### Logout
POST {{baseUrl}}/auth/logout
Authorization: Bearer {{accessToken}}

### ============================================
### Tasks
### ============================================

### Create Task
POST {{baseUrl}}/tasks
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "title": "Implement user dashboard",
  "description": "Create a comprehensive dashboard for users to view their activities",
  "priority": "high",
  "due_date": "2024-12-31T23:59:59Z"
}

### List All Tasks
GET {{baseUrl}}/tasks
Authorization: Bearer {{accessToken}}

### List Tasks by Status
GET {{baseUrl}}/tasks?status=todo
Authorization: Bearer {{accessToken}}

### List My Tasks
GET {{baseUrl}}/tasks/my
Authorization: Bearer {{accessToken}}

### Get Single Task
GET {{baseUrl}}/tasks/task-id-here
Authorization: Bearer {{accessToken}}

### Update Task
PATCH {{baseUrl}}/tasks/task-id-here
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "status": "in_progress",
  "description": "Updated description"
}

### Delete Task
DELETE {{baseUrl}}/tasks/task-id-here
Authorization: Bearer {{accessToken}}

### ============================================
### Issues
### ============================================

### Create Issue (with AI Summary)
POST {{baseUrl}}/issues
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "title": "Login page not loading on Safari",
  "description": "When users try to access the login page using Safari browser on macOS, the page shows a blank screen. This works fine on Chrome and Firefox. The browser console shows a CORS error. This is affecting approximately 15% of our user base who prefer Safari.",
  "severity": "high"
}

### List All Issues
GET {{baseUrl}}/issues
Authorization: Bearer {{accessToken}}

### List Issues by Status
GET {{baseUrl}}/issues?status=open
Authorization: Bearer {{accessToken}}

### Get Single Issue
GET {{baseUrl}}/issues/issue-id-here
Authorization: Bearer {{accessToken}}

### Update Issue
PATCH {{baseUrl}}/issues/issue-id-here
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "status": "in_progress",
  "severity": "critical"
}

### Resolve Issue
PATCH {{baseUrl}}/issues/issue-id-here
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "status": "resolved"
}

### Delete Issue
DELETE {{baseUrl}}/issues/issue-id-here
Authorization: Bearer {{accessToken}}

### ============================================
### Users (Admin/Manager only)
### ============================================

### Create User
POST {{baseUrl}}/users
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "email": "newuser@test.com",
  "password": "password123",
  "first_name": "New",
  "last_name": "User",
  "role": "member"
}

### List All Users
GET {{baseUrl}}/users
Authorization: Bearer {{accessToken}}

### Get User by ID
GET {{baseUrl}}/users/user-id-here
Authorization: Bearer {{accessToken}}

### Update User
PATCH {{baseUrl}}/users/user-id-here
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "first_name": "Updated",
  "last_name": "Name",
  "role": "manager"
}

### Delete User (Admin only)
DELETE {{baseUrl}}/users/user-id-here
Authorization: Bearer {{accessToken}}
